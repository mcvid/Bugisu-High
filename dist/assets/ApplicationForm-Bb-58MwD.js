import{u as L,H as w,r as d,j as s,a as h,J as D,F as R,s as x}from"./index-DnZapYtk.js";import{C as A}from"./check-circle-DznmAU8U.js";import{U as N}from"./user-hLTyjqTW.js";import{C as f}from"./chevron-left-2etBaAd6.js";import{U as y}from"./upload-BXbAIg_5.js";const B=()=>{const{t:e}=L(["admissions","common"]),g=w(),[o,c]=d.useState(1),[j,_]=d.useState(!1),[C,S]=d.useState(!1),[i,k]=d.useState({student_name:"",date_of_birth:"",gender:"",religion:"",nationality:"",program:"O-Level",entry_class:"S1",previous_school:"",ple_aggregates:"",uce_aggregates:"",parent_name:"",parent_phone:"",parent_email:"",parent_occupation:"",photo_url:"",result_slip_url:""}),[r,z]=d.useState({photo:null,result_slip:null}),[q,F]=d.useState(""),n=a=>{k({...i,[a.target.name]:a.target.value})},v=(a,t)=>{const l=a.target.files[0];l&&z({...r,[t]:l})},b=async(a,t)=>{const l=a.name.split(".").pop(),m=`${t}/${Date.now()}.${l}`,{error:p}=await x.storage.from("applications").upload(m,a);if(p)throw p;const{data:u}=x.storage.from("applications").getPublicUrl(m);return u.publicUrl},U=()=>{const a="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let t="";for(let l=0;l<8;l++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},$=async a=>{a.preventDefault(),_(!0);try{let t="",l="";r.photo&&(t=await b(r.photo,"photos")),r.result_slip&&(l=await b(r.result_slip,"results"));const m=U();F(m);const p={...i,ple_aggregates:i.ple_aggregates===""?null:parseInt(i.ple_aggregates),uce_aggregates:i.uce_aggregates===""?null:parseInt(i.uce_aggregates),photo_url:t,result_slip_url:l,status:"pending",reference_no:m},{error:u}=await x.from("admission_applications").insert([p]);if(u)throw u;S(!0)}catch(t){console.error("Error submitting application:",t),alert("Failed to submit application. Please try again.")}finally{_(!1)}};return C?s.jsx("div",{className:"application-success",children:s.jsxs("div",{className:"success-content",children:[s.jsx(A,{size:64,color:"#4ade80"}),s.jsx("h2",{children:e("admissions:form.success_title")}),s.jsx("p",{children:e("admissions:form.success_desc")}),s.jsxs("div",{className:"reference-box",style:{margin:"2rem 0",padding:"1.5rem",background:"#f0fdf4",border:"2px dashed #22c55e",borderRadius:"12px",textAlign:"center"},children:[s.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#166534",textTransform:"uppercase",letterSpacing:"1px",fontWeight:"bold"},children:e("admissions:form.ref_label")}),s.jsx("h1",{style:{margin:"0.5rem 0",color:"#16a34a",fontSize:"3rem",letterSpacing:"4px"},children:q}),s.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#166534"},children:e("admissions:form.ref_note")})]}),s.jsx("p",{children:e("admissions:form.contact_note")}),s.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",marginTop:"1rem"},children:[s.jsx("button",{onClick:()=>g("/"),className:"btn btn-primary",children:e("admissions:form.return_home")}),s.jsx("button",{onClick:()=>g("/admissions"),className:"btn btn-outline",children:e("admissions:form.track_status")})]})]})}):s.jsx("div",{className:"application-page section",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"form-header",children:[s.jsx("h1",{children:e("admissions:form.title")}),s.jsx("p",{children:e("admissions:form.subtitle")})]}),s.jsxs("div",{className:"progress-bar-container",children:[s.jsxs("div",{className:"progress-status",children:[e("admissions:form.step")," ",o," ",e("admissions:form.of")," 4: ",e(o===1?"admissions:form.student_info":o===2?"admissions:form.academic_info":o===3?"admissions:form.parent_info":"admissions:form.documents")]}),s.jsxs("div",{className:"progress-bar",children:[s.jsxs("div",{className:`progress-step ${o>=1?"active":""}`,children:[s.jsx("span",{children:"1"}),s.jsx("label",{children:e("admissions:form.student_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=2?"active":""}`,children:[s.jsx("span",{children:"2"}),s.jsx("label",{children:e("admissions:form.academic_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=3?"active":""}`,children:[s.jsx("span",{children:"3"}),s.jsx("label",{children:e("admissions:form.parent_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=4?"active":""}`,children:[s.jsx("span",{children:"4"}),s.jsx("label",{children:"Docs"})]})]})]}),s.jsxs("form",{className:"application-form card",onSubmit:$,children:[o===1&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(N,{size:20})," ",e("admissions:form.student_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.full_name")," *"]}),s.jsx("input",{type:"text",name:"student_name",required:!0,value:i.student_name,onChange:n})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.date_of_birth")," *"]}),s.jsx("input",{type:"date",name:"date_of_birth",required:!0,value:i.date_of_birth,onChange:n})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.gender")," *"]}),s.jsxs("select",{name:"gender",required:!0,value:i.gender,onChange:n,children:[s.jsx("option",{value:"",children:e("admissions:form.select_gender")}),s.jsx("option",{value:"Male",children:e("admissions:form.male")}),s.jsx("option",{value:"Female",children:e("admissions:form.female")})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.nationality")," *"]}),s.jsx("input",{type:"text",name:"nationality",required:!0,value:i.nationality,onChange:n})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.religion")}),s.jsx("input",{type:"text",name:"religion",value:i.religion,onChange:n})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsx("div",{}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>c(2),disabled:!i.student_name||!i.date_of_birth||!i.gender||!i.nationality,children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===2&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(D,{size:20})," ",e("admissions:form.academic_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.program_applying_for")," *"]}),s.jsxs("select",{name:"program",required:!0,value:i.program,onChange:n,children:[s.jsx("option",{value:"O-Level",children:e("admissions:form.o_level")}),s.jsx("option",{value:"A-Level",children:e("admissions:form.a_level")})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.entry_class")," *"]}),s.jsxs("select",{name:"entry_class",required:!0,value:i.entry_class,onChange:n,children:[s.jsx("option",{value:"S1",children:e("admissions:form.senior_1")}),s.jsx("option",{value:"S2",children:e("admissions:form.senior_2")}),s.jsx("option",{value:"S3",children:e("admissions:form.senior_3")}),s.jsx("option",{value:"S5",children:e("admissions:form.senior_5")})]})]}),s.jsxs("div",{className:"form-group full",children:[s.jsxs("label",{children:[e("admissions:form.previous_school")," *"]}),s.jsx("input",{type:"text",name:"previous_school",required:!0,value:i.previous_school,onChange:n})]}),i.program==="O-Level"?s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.ple_aggregates")," *"]}),s.jsx("input",{type:"number",name:"ple_aggregates",required:!0,value:i.ple_aggregates,onChange:n,placeholder:"e.g. 12"})]}):s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.uce_aggregates")," *"]}),s.jsx("input",{type:"number",name:"uce_aggregates",required:!0,value:i.uce_aggregates,onChange:n,placeholder:"e.g. 30"})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>c(1),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>c(3),disabled:!i.previous_school||(i.program==="O-Level"?!i.ple_aggregates:!i.uce_aggregates),children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===3&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(N,{size:20})," ",e("admissions:form.parent_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.parent_name")," *"]}),s.jsx("input",{type:"text",name:"parent_name",required:!0,value:i.parent_name,onChange:n})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.phone_number")," *"]}),s.jsx("input",{type:"tel",name:"parent_phone",required:!0,value:i.parent_phone,onChange:n,placeholder:"+256..."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.email_address")}),s.jsx("input",{type:"email",name:"parent_email",value:i.parent_email,onChange:n})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.occupation")}),s.jsx("input",{type:"text",name:"parent_occupation",value:i.parent_occupation,onChange:n})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>c(2),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>c(4),disabled:!i.parent_name||!i.parent_phone,children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===4&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(R,{size:20})," ",e("admissions:form.documents")]}),s.jsx("p",{className:"form-note",children:e("admissions:form.upload_note")}),s.jsxs("div",{className:"upload-grid",children:[s.jsxs("div",{className:"upload-box",children:[s.jsx("label",{children:e("admissions:form.upload_passport")}),s.jsxs("div",{className:`file-drop ${r.photo?"has-file":""}`,children:[s.jsx("input",{type:"file",accept:"image/*",onChange:a=>v(a,"photo")}),s.jsxs("div",{className:"drop-content",children:[s.jsx(y,{size:32}),s.jsx("span",{children:r.photo?r.photo.name:e("admissions:form.click_to_upload_photo")})]})]})]}),s.jsxs("div",{className:"upload-box",children:[s.jsx("label",{children:e("admissions:form.upload_results")}),s.jsxs("div",{className:`file-drop ${r.result_slip?"has-file":""}`,children:[s.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:a=>v(a,"result_slip")}),s.jsxs("div",{className:"drop-content",children:[s.jsx(y,{size:32}),s.jsx("span",{children:r.result_slip?r.result_slip.name:e("admissions:form.click_to_upload_slip")})]})]})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>c(3),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsx("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:j||!r.photo||!r.result_slip,children:e(j?"admissions:form.submitting":"admissions:form.submit")})]})]})]})]})})};export{B as default};
