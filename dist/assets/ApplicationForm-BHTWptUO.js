import{u as $,h as D,r as c,j as s,a as h,i as L,F as A,s as x}from"./index-EH-KDdP-.js";import{C as E}from"./check-circle-DoFw_Y84.js";import{U as y}from"./user-Cqkhr_uV.js";import{C as f}from"./chevron-left-GT57DOTz.js";import{U as C}from"./upload-ny2dlU1l.js";const B=()=>{const{t:e}=$(["admissions","common"]),g=D(),[o,d]=c.useState(1),[j,_]=c.useState(!1),[S,k]=c.useState(!1),[a,z]=c.useState({student_name:"",date_of_birth:"",gender:"",religion:"",nationality:"",program:"O-Level",entry_class:"S1",previous_school:"",ple_aggregates:"",uce_aggregates:"",parent_name:"",parent_phone:"",parent_email:"",parent_occupation:"",photo_url:"",result_slip_url:""}),[n,q]=c.useState({photo:null,result_slip:null}),[R,F]=c.useState(""),[b,w]=c.useState(!1),r=i=>{z({...a,[i.target.name]:i.target.value})},v=(i,t)=>{const l=i.target.files[0];l&&q({...n,[t]:l})},N=async(i,t)=>{const l=i.name.split(".").pop(),m=`${t}/${Date.now()}.${l}`,{error:p}=await x.storage.from("applications").upload(m,i);if(p)throw p;const{data:u}=x.storage.from("applications").getPublicUrl(m);return u.publicUrl},T=()=>{const i="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let t="";for(let l=0;l<8;l++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},U=async i=>{i.preventDefault(),_(!0);try{let t="",l="";n.photo&&(t=await N(n.photo,"photos")),n.result_slip&&(l=await N(n.result_slip,"results"));const m=T();F(m);const p={...a,ple_aggregates:a.ple_aggregates===""?null:parseInt(a.ple_aggregates),uce_aggregates:a.uce_aggregates===""?null:parseInt(a.uce_aggregates),photo_url:t,result_slip_url:l,status:"pending",reference_no:m},{error:u}=await x.from("admission_applications").insert([p]);if(u)throw u;k(!0)}catch(t){console.error("Error submitting application:",t),alert("Failed to submit application. Please try again.")}finally{_(!1)}};return S?s.jsx("div",{className:"application-success",children:s.jsxs("div",{className:"success-content",children:[s.jsx(E,{size:64,color:"#4ade80"}),s.jsx("h2",{children:e("admissions:form.success_title")}),s.jsx("p",{children:e("admissions:form.success_desc")}),s.jsxs("div",{className:"reference-box",style:{margin:"2rem 0",padding:"1.5rem",background:"#f0fdf4",border:"2px dashed #22c55e",borderRadius:"12px",textAlign:"center"},children:[s.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#166534",textTransform:"uppercase",letterSpacing:"1px",fontWeight:"bold"},children:e("admissions:form.ref_label")}),s.jsx("h1",{style:{margin:"0.5rem 0",color:"#16a34a",fontSize:"3rem",letterSpacing:"4px"},children:R}),s.jsx("p",{style:{margin:0,fontSize:"0.875rem",color:"#166534"},children:e("admissions:form.ref_note")})]}),s.jsx("p",{children:e("admissions:form.contact_note")}),s.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",marginTop:"1rem"},children:[s.jsx("button",{onClick:()=>g("/"),className:"btn btn-primary",children:e("admissions:form.return_home")}),s.jsx("button",{onClick:()=>g("/admissions"),className:"btn btn-outline",children:e("admissions:form.track_status")})]})]})}):s.jsx("div",{className:"application-page section",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"form-header",children:[s.jsx("h1",{children:e("admissions:form.title")}),s.jsx("p",{children:e("admissions:form.subtitle")})]}),s.jsxs("div",{className:"progress-bar-container",children:[s.jsxs("div",{className:"progress-status",children:[e("admissions:form.step")," ",o," ",e("admissions:form.of")," 4: ",e(o===1?"admissions:form.student_info":o===2?"admissions:form.academic_info":o===3?"admissions:form.parent_info":"admissions:form.documents")]}),s.jsxs("div",{className:"progress-bar",children:[s.jsxs("div",{className:`progress-step ${o>=1?"active":""}`,children:[s.jsx("span",{children:"1"}),s.jsx("label",{children:e("admissions:form.student_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=2?"active":""}`,children:[s.jsx("span",{children:"2"}),s.jsx("label",{children:e("admissions:form.academic_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=3?"active":""}`,children:[s.jsx("span",{children:"3"}),s.jsx("label",{children:e("admissions:form.parent_info").split(" ")[0]})]}),s.jsxs("div",{className:`progress-step ${o>=4?"active":""}`,children:[s.jsx("span",{children:"4"}),s.jsx("label",{children:"Docs"})]})]})]}),s.jsxs("form",{className:"application-form card",onSubmit:U,children:[o===1&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(y,{size:20})," ",e("admissions:form.student_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.full_name")," *"]}),s.jsx("input",{type:"text",name:"student_name",required:!0,value:a.student_name,onChange:r})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.date_of_birth")," *"]}),s.jsx("input",{type:"date",name:"date_of_birth",required:!0,value:a.date_of_birth,onChange:r})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.gender")," *"]}),s.jsxs("select",{name:"gender",required:!0,value:a.gender,onChange:r,children:[s.jsx("option",{value:"",children:e("admissions:form.select_gender")}),s.jsx("option",{value:"Male",children:e("admissions:form.male")}),s.jsx("option",{value:"Female",children:e("admissions:form.female")})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.nationality")," *"]}),s.jsx("input",{type:"text",name:"nationality",required:!0,value:a.nationality,onChange:r})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.religion")}),s.jsx("input",{type:"text",name:"religion",value:a.religion,onChange:r})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsx("div",{}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>d(2),disabled:!a.student_name||!a.date_of_birth||!a.gender||!a.nationality,children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===2&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(L,{size:20})," ",e("admissions:form.academic_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.program_applying_for")," *"]}),s.jsxs("select",{name:"program",required:!0,value:a.program,onChange:r,children:[s.jsx("option",{value:"O-Level",children:e("admissions:form.o_level")}),s.jsx("option",{value:"A-Level",children:e("admissions:form.a_level")})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.entry_class")," *"]}),s.jsxs("select",{name:"entry_class",required:!0,value:a.entry_class,onChange:r,children:[s.jsx("option",{value:"S1",children:e("admissions:form.senior_1")}),s.jsx("option",{value:"S2",children:e("admissions:form.senior_2")}),s.jsx("option",{value:"S3",children:e("admissions:form.senior_3")}),s.jsx("option",{value:"S5",children:e("admissions:form.senior_5")})]})]}),s.jsxs("div",{className:"form-group full",children:[s.jsxs("label",{children:[e("admissions:form.previous_school")," *"]}),s.jsx("input",{type:"text",name:"previous_school",required:!0,value:a.previous_school,onChange:r})]}),a.program==="O-Level"?s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.ple_aggregates")," *"]}),s.jsx("input",{type:"number",name:"ple_aggregates",required:!0,value:a.ple_aggregates,onChange:r,placeholder:"e.g. 12"})]}):s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.uce_aggregates")," *"]}),s.jsx("input",{type:"number",name:"uce_aggregates",required:!0,value:a.uce_aggregates,onChange:r,placeholder:"e.g. 30"})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>d(1),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>d(3),disabled:!a.previous_school||(a.program==="O-Level"?!a.ple_aggregates:!a.uce_aggregates),children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===3&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(y,{size:20})," ",e("admissions:form.parent_info")]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.parent_name")," *"]}),s.jsx("input",{type:"text",name:"parent_name",required:!0,value:a.parent_name,onChange:r})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[e("admissions:form.phone_number")," *"]}),s.jsx("input",{type:"tel",name:"parent_phone",required:!0,value:a.parent_phone,onChange:r,placeholder:"+256..."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.email_address")}),s.jsx("input",{type:"email",name:"parent_email",value:a.parent_email,onChange:r})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:e("admissions:form.occupation")}),s.jsx("input",{type:"text",name:"parent_occupation",value:a.parent_occupation,onChange:r})]})]}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>d(2),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsxs("button",{type:"button",className:"btn btn-primary",onClick:()=>d(4),disabled:!a.parent_name||!a.parent_phone,children:[e("admissions:form.next_step")," ",s.jsx(h,{size:18})]})]})]}),o===4&&s.jsxs("div",{className:"form-step",children:[s.jsxs("h3",{children:[s.jsx(A,{size:20})," ",e("admissions:form.documents")]}),s.jsx("p",{className:"form-note",children:e("admissions:form.upload_note")}),s.jsxs("div",{className:"upload-grid",children:[s.jsxs("div",{className:"upload-box",children:[s.jsx("label",{children:e("admissions:form.upload_passport")}),s.jsxs("div",{className:`file-drop ${n.photo?"has-file":""}`,children:[s.jsx("input",{type:"file",accept:"image/*",onChange:i=>v(i,"photo")}),s.jsxs("div",{className:"drop-content",children:[s.jsx(C,{size:32}),s.jsx("span",{children:n.photo?n.photo.name:e("admissions:form.click_to_upload_photo")})]})]})]}),s.jsxs("div",{className:"upload-box",children:[s.jsx("label",{children:e("admissions:form.upload_results")}),s.jsxs("div",{className:`file-drop ${n.result_slip?"has-file":""}`,children:[s.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:i=>v(i,"result_slip")}),s.jsxs("div",{className:"drop-content",children:[s.jsx(C,{size:32}),s.jsx("span",{children:n.result_slip?n.result_slip.name:e("admissions:form.click_to_upload_slip")})]})]})]})]}),s.jsx("div",{className:"agreement-section",style:{marginTop:"2rem",padding:"1rem",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:s.jsxs("label",{style:{display:"flex",gap:"12px",alignItems:"flex-start",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",required:!0,checked:b,onChange:i=>w(i.target.checked),style:{marginTop:"4px",width:"20px",height:"20px"}}),s.jsxs("span",{style:{fontSize:"0.95rem",color:"#334155",lineHeight:"1.5"},children:["I agree to adhere to the ",s.jsx("a",{href:"/school-rules",target:"_blank",rel:"noopener noreferrer",style:{color:"#ea580c",fontWeight:"600",textDecoration:"underline"},children:"School Rules and Regulations"}),". I understand that failure to comply will result in disciplinary actions."]})]})}),s.jsxs("div",{className:"step-actions sticky-mobile",children:[s.jsxs("button",{type:"button",className:"btn btn-outline",onClick:()=>d(3),children:[s.jsx(f,{size:18})," ",e("admissions:form.prev_step")]}),s.jsx("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:j||!n.photo||!n.result_slip||!b,children:e(j?"admissions:form.submitting":"admissions:form.submit")})]})]})]})]})})};export{B as default};
