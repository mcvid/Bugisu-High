import{c as q,r as c,s as m,j as e,L as F,J as A,a5 as G,G as W,U as J,a7 as X,X as k}from"./index-BwtYp3Ig.js";import{P as _}from"./pencil-DSj-Luxt.js";import{T as w}from"./trash-2-CNEj7xb6.js";import{S as z}from"./save-BnUOIqxV.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=q("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Z=()=>{const[r,f]=c.useState("levels"),[g,E]=c.useState([]),[y,O]=c.useState([]),[L,R]=c.useState([]),[h,j]=c.useState([]),[d,M]=c.useState("Senior 1"),[$,D]=c.useState(!0),[b,p]=c.useState(null),[a,n]=c.useState({}),[I,u]=c.useState(!1),B=["Senior 1","Senior 2","Senior 3","Senior 4","Senior 5","Senior 6"];c.useEffect(()=>{v()},[]);const v=async()=>{D(!0);const[s,i,t,x]=await Promise.all([m.from("academic_levels").select("*").order("sort_order",{ascending:!0}),m.from("departments").select("*").order("name",{ascending:!0}),m.from("subjects").select("*").order("name",{ascending:!0}),m.from("class_subjects").select("*")]);E(s.data||[]),O(i.data||[]),R(t.data||[]),j(x.data||[]),D(!1)},S=(s,i)=>{p(s),n(i)},C=async s=>{const{id:i,...t}=a,{error:x}=i?await m.from(s).update(t).eq("id",i):await m.from(s).insert(t);x?alert("Error saving: "+x.message):(p(null),u(!1),n({}),v())},N=async(s,i)=>{if(!window.confirm("Are you sure you want to delete this?"))return;const{error:t}=await m.from(s).delete().eq("id",i);t?alert("Error deleting: "+t.message):v()},T=()=>e.jsxs("div",{className:"admin-form-card",children:[e.jsx("h3",{children:b?"Edit Level":"Add Level"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name (e.g. O-Level)"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),placeholder:"O-Level"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>n({...a,description:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:s=>n({...a,sort_order:parseInt(s.target.value)})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>C("academic_levels"),children:[e.jsx(z,{size:18})," Save Level"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>{p(null),u(!1)},children:[e.jsx(k,{size:18})," Cancel"]})]})]}),P=()=>e.jsxs("div",{className:"admin-form-card",children:[e.jsx("h3",{children:b?"Edit Department":"Add Department"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Department Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>n({...a,description:s.target.value})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>C("departments"),children:[e.jsx(z,{size:18})," Save Department"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>{p(null),u(!1)},children:[e.jsx(k,{size:18})," Cancel"]})]})]}),U=()=>e.jsxs("div",{className:"admin-form-card",children:[e.jsx("h3",{children:b?"Edit Subject":"Add Subject"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Subject Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Level"}),e.jsxs("select",{value:a.level_id||"",onChange:s=>n({...a,level_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Level"}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Department"}),e.jsxs("select",{value:a.department_id||"",onChange:s=>n({...a,department_id:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Department (Optional)"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>C("subjects"),children:[e.jsx(z,{size:18})," Save Subject"]}),e.jsxs("button",{className:"btn btn-outline",onClick:()=>{p(null),u(!1)},children:[e.jsx(k,{size:18})," Cancel"]})]})]});return e.jsxs("div",{className:"admin-manager academics-manager",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{children:"Academic Management"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs(F,{to:"/admin/academics/marks",className:"btn btn-secondary",style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(A,{size:18})," Enter Marks"]}),!I&&!b&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>{u(!0),n({})},children:[e.jsx(G,{size:18})," Add New ",r.slice(0,-1)]})]})]}),e.jsxs("div",{className:"admin-tabs",style:{display:"flex",gap:"1rem",marginBottom:"2rem",borderBottom:"1px solid #eee",paddingBottom:"1rem"},children:[e.jsxs("button",{className:`btn ${r==="levels"?"btn-primary":"btn-outline"}`,onClick:()=>{f("levels"),u(!1),p(null),n({})},children:[e.jsx(W,{size:18})," Levels"]}),e.jsxs("button",{className:`btn ${r==="depts"?"btn-primary":"btn-outline"}`,onClick:()=>{f("depts"),u(!1),p(null),n({})},children:[e.jsx(J,{size:18})," Departments"]}),e.jsxs("button",{className:`btn ${r==="subjects"?"btn-primary":"btn-outline"}`,onClick:()=>{f("subjects"),u(!1),p(null),n({})},children:[e.jsx(A,{size:18})," Subjects"]}),e.jsxs("button",{className:`btn ${r==="classSubjects"?"btn-primary":"btn-outline"}`,onClick:()=>{f("classSubjects"),u(!1),p(null),n({})},children:[e.jsx(Y,{size:18})," Class Subjects"]})]}),(I||b)&&e.jsxs("div",{style:{marginBottom:"2rem"},children:[r==="levels"&&T(),r==="depts"&&P(),r==="subjects"&&U()]}),$?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{className:"admin-list-grid",children:[r==="levels"&&g.map(s=>e.jsx("div",{className:"admin-list-item",style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"1px solid #eee",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:s.name}),e.jsx("p",{style:{color:"#666",margin:"0.5rem 0"},children:s.description}),e.jsxs("span",{style:{fontSize:"0.8rem",background:"#f0f0f0",padding:"2px 8px",borderRadius:"4px"},children:["Order: ",s.sort_order]})]}),e.jsxs("div",{className:"actions",style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn-icon",onClick:()=>S(s.id,s),children:e.jsx(_,{size:18})}),e.jsx("button",{className:"btn-icon delete",onClick:()=>N("academic_levels",s.id),children:e.jsx(w,{size:18})})]})]})},s.id)),r==="depts"&&y.map(s=>e.jsx("div",{className:"admin-list-item",style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"1px solid #eee",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:s.name}),e.jsx("p",{style:{color:"#666",margin:"0.5rem 0"},children:s.description})]}),e.jsxs("div",{className:"actions",style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn-icon",onClick:()=>S(s.id,s),children:e.jsx(_,{size:18})}),e.jsx("button",{className:"btn-icon delete",onClick:()=>N("departments",s.id),children:e.jsx(w,{size:18})})]})]})},s.id)),r==="subjects"&&L.map(s=>{var i,t;return e.jsx("div",{className:"admin-list-item",style:{background:"white",padding:"1.5rem",borderRadius:"8px",border:"1px solid #eee",marginBottom:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:s.name}),e.jsxs("p",{style:{color:"#666",fontSize:"0.9rem",margin:"0.25rem 0"},children:[((i=g.find(x=>x.id===s.level_id))==null?void 0:i.name)||"Unknown Level",s.department_id&&` â€¢ ${((t=y.find(x=>x.id===s.department_id))==null?void 0:t.name)||"Unknown Dept"}`]})]}),e.jsxs("div",{className:"actions",style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn-icon",onClick:()=>S(s.id,s),children:e.jsx(_,{size:18})}),e.jsx("button",{className:"btn-icon delete",onClick:()=>N("subjects",s.id),children:e.jsx(w,{size:18})})]})]})},s.id)}),r==="classSubjects"&&e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",border:"1px solid #eee"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{fontWeight:"bold",marginRight:"1rem"},children:"Select Class:"}),e.jsx("select",{value:d,onChange:s=>M(s.target.value),style:{padding:"0.5rem 1rem",borderRadius:"6px",border:"1px solid #ccc",fontSize:"1rem"},children:B.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("p",{style:{color:"#666",marginBottom:"1rem"},children:["Select the subjects that ",e.jsx("strong",{children:d})," students study:"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"0.75rem"},children:L.map(s=>{const i=h.some(l=>l.class_name===d&&l.subject_id===s.id),t=h.find(l=>l.class_name===d&&l.subject_id===s.id),x=async()=>{if(i)j(l=>l.filter(o=>o.id!==t.id)),await m.from("class_subjects").delete().eq("id",t.id);else{const l={id:crypto.randomUUID(),class_name:d,subject_id:s.id,is_compulsory:!1};j(o=>[...o,l]),await m.from("class_subjects").insert({class_name:d,subject_id:s.id,is_compulsory:!1})}};return e.jsxs("div",{onClick:x,style:{padding:"0.75rem 1rem",borderRadius:"8px",border:i?"2px solid #22c55e":"1px solid #ddd",background:i?"#f0fdf4":"white",cursor:"pointer",display:"flex",alignItems:"flex-start",gap:"0.75rem",transition:"all 0.2s"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"4px",border:i?"none":"2px solid #ccc",background:i?"#22c55e":"white",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:i&&e.jsx(X,{size:14,color:"white"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[e.jsx("span",{style:{fontWeight:i?"500":"400"},children:s.name}),i&&e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginTop:"0.4rem"},onClick:l=>l.stopPropagation(),children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer",fontSize:"0.8rem"},children:[e.jsx("input",{type:"radio",name:`type-${s.id}`,checked:(t==null?void 0:t.is_compulsory)===!0,onChange:()=>{window.confirm(`Make "${s.name}" COMPULSORY for ${d}?`)&&(j(l=>l.map(o=>o.id===t.id?{...o,is_compulsory:!0}:o)),m.from("class_subjects").update({is_compulsory:!0}).eq("id",t.id))},style:{accentColor:"#3b82f6",cursor:"pointer"}}),e.jsx("span",{style:{color:t!=null&&t.is_compulsory?"#3b82f6":"#6b7280",fontWeight:t!=null&&t.is_compulsory?"bold":"normal"},children:"Comp"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer",fontSize:"0.8rem"},children:[e.jsx("input",{type:"radio",name:`type-${s.id}`,checked:(t==null?void 0:t.is_compulsory)===!1,onChange:()=>{window.confirm(`Make "${s.name}" OPTIONAL for ${d}?`)&&(j(l=>l.map(o=>o.id===t.id?{...o,is_compulsory:!1}:o)),m.from("class_subjects").update({is_compulsory:!1}).eq("id",t.id))},style:{accentColor:"#f59e0b",cursor:"pointer"}}),e.jsx("span",{style:{color:t!=null&&t.is_compulsory?"#6b7280":"#f59e0b",fontWeight:t!=null&&t.is_compulsory?"normal":"bold"},children:"OPT"})]})]})]})]},s.id)})}),e.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"#f8fafc",borderRadius:"8px"},children:[e.jsxs("strong",{children:["Summary for ",d,":"]}),e.jsxs("span",{style:{marginLeft:"1rem"},children:[h.filter(s=>s.class_name===d).length," subjects assigned (",h.filter(s=>s.class_name===d&&s.is_compulsory).length," compulsory,",h.filter(s=>s.class_name===d&&!s.is_compulsory).length," optional)"]})]})]})]})]})};export{Z as default};
