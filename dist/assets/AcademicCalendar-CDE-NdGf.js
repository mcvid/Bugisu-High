import{r,s as u,j as e,a as T,C as _}from"./index-EH-KDdP-.js";import{C as L}from"./chevron-left-GT57DOTz.js";import{M as E}from"./map-pin-DeFOtuOP.js";import{C as F}from"./clock-Da-uQ_oS.js";const B=()=>{const[s,d]=r.useState(new Date),[l,m]=r.useState([]),[g,h]=r.useState(!0),[a,i]=r.useState(null);r.useEffect(()=>{j()},[]);const j=async()=>{h(!0);const{data:t}=await u.from("events").select("*").order("event_date",{ascending:!0});t&&m(t),h(!1)},f=t=>new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),v=t=>new Date(t.getFullYear(),t.getMonth(),1).getDay(),y=()=>{d(new Date(s.getFullYear(),s.getMonth()+1,1)),i(null)},D=()=>{d(new Date(s.getFullYear(),s.getMonth()-1,1)),i(null)},N=()=>{const t=f(s),S=v(s),x=[];for(let n=0;n<S;n++)x.push(e.jsx("div",{className:"calendar-day empty"},`empty-${n}`));for(let n=1;n<=t;n++){const o=new Date(s.getFullYear(),s.getMonth(),n).toDateString(),w=l.filter(c=>new Date(c.event_date).toDateString()===o),C=new Date().toDateString()===o,M=a===o;x.push(e.jsxs("div",{className:`calendar-day ${C?"today":""} ${M?"selected":""}`,onClick:()=>i(o),children:[e.jsx("span",{className:"day-number",children:n}),e.jsx("div",{className:"day-dots",children:w.map(c=>e.jsx("span",{className:`event-dot ${c.category.toLowerCase().replace(/\s+/g,"-")}`,title:c.title},c.id))})]},n))}return x},b=t=>t.toLocaleString("default",{month:"long",year:"numeric"}),p=a?l.filter(t=>new Date(t.event_date).toDateString()===a):l.filter(t=>new Date(t.event_date)>=new Date&&new Date(t.event_date).getMonth()===s.getMonth()).slice(0,5);return e.jsx("div",{className:"calendar-page section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"page-header center",children:[e.jsx("h1",{children:"Academic Calendar"}),e.jsx("p",{children:"Keep track of important school dates, exams, and holidays."})]}),e.jsxs("div",{className:"calendar-container card",children:[e.jsxs("div",{className:"calendar-header",children:[e.jsx("button",{onClick:D,className:"nav-btn",children:e.jsx(L,{size:24})}),e.jsx("h2",{children:b(s)}),e.jsx("button",{onClick:y,className:"nav-btn",children:e.jsx(T,{size:24})})]}),e.jsxs("div",{className:"calendar-grid-header",children:[e.jsx("div",{children:"Sun"}),e.jsx("div",{children:"Mon"}),e.jsx("div",{children:"Tue"}),e.jsx("div",{children:"Wed"}),e.jsx("div",{children:"Thu"}),e.jsx("div",{children:"Fri"}),e.jsx("div",{children:"Sat"})]}),e.jsx("div",{className:"calendar-grid",children:N()})]}),e.jsx(k,{}),e.jsxs("div",{className:"events-agenda section-grey",style:{marginTop:"3rem"},children:[e.jsx("h3",{children:a?`Events for ${new Date(a).toLocaleDateString()}`:"Upcoming Events This Month"}),e.jsx("div",{className:"agenda-list",children:g?e.jsx("p",{children:"Loading events..."}):p.length===0?e.jsx("p",{className:"no-events text-muted",children:"No events scheduled for this period."}):p.map(t=>e.jsxs("div",{className:"agenda-item card",children:[e.jsxs("div",{className:`event-date-box ${t.category.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsx("span",{className:"month",children:new Date(t.event_date).toLocaleString("default",{month:"short"})}),e.jsx("span",{className:"day",children:new Date(t.event_date).getDate()})]}),e.jsxs("div",{className:"event-details",children:[e.jsx("h4",{children:t.title}),e.jsxs("div",{className:"meta",children:[e.jsx("span",{className:"category-tag",children:t.category}),t.location&&e.jsxs("span",{children:[e.jsx(E,{size:14})," ",t.location]}),e.jsxs("span",{children:[e.jsx(F,{size:14})," ",new Date(t.event_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),t.description&&e.jsx("p",{children:t.description})]})]},t.id))})]})]})})},k=()=>{const[s,d]=r.useState([]),[l,m]=r.useState(!0),[g,h]=r.useState(null);return r.useEffect(()=>{(async()=>{const{data:i}=await u.from("past_papers").select("*").eq("paper_type","Timetable").order("created_at",{ascending:!1}).limit(3);i&&d(i),m(!1)})()},[]),l||s.length===0?null:e.jsxs("div",{className:"timetables-section card",style:{padding:"1.5rem",marginBottom:"2rem",borderLeft:"4px solid #f59e0b"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:e.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem",color:"#b45309"},children:[e.jsx(_,{size:20})," Latest Exam Timetables"]})}),e.jsx("div",{className:"timetables-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:s.map(a=>e.jsxs("a",{href:a.file_url,target:"_blank",rel:"noopener noreferrer",className:"timetable-card",style:{display:"flex",flexDirection:"column",padding:"1rem",background:"#fffbeb",borderRadius:"8px",textDecoration:"none",color:"inherit",border:"1px solid #fcd34d"},children:[e.jsx("span",{style:{fontWeight:"600",marginBottom:"0.25rem"},children:a.title}),e.jsxs("span",{style:{fontSize:"0.85rem",color:"#92400e"},children:[a.level," â€¢ ",a.year]})]},a.id))})]})};export{B as default};
