import{r as n,s as d,j as e,a5 as k,X as A,C as I}from"./index-DnZapYtk.js";import{S as N}from"./save-BWmYaoU4.js";import{C as y}from"./clock-CE5dkPOa.js";import{T as D}from"./trash-2-CjA1UK2C.js";const R=()=>{const[m,b]=n.useState([]),[h,g]=n.useState(!0),[u,r]=n.useState(!1),[o,c]=n.useState(null),[a,x]=n.useState({message:"",target_date:"",target_label:"Countdown:",is_active:!1,type:"info"});n.useEffect(()=>{p()},[]);const p=async()=>{g(!0);const{data:t,error:s}=await d.from("site_alerts").select("*").order("created_at",{ascending:!1});t&&b(t),g(!1)},l=t=>{const{name:s,value:i,type:C,checked:w}=t.target;x(S=>({...S,[s]:C==="checkbox"?w:i}))},f=async t=>{t.preventDefault(),g(!0);const s={...a,target_date:a.target_date||null};if(o){const{error:i}=await d.from("site_alerts").update(s).eq("id",o);i&&alert(i.message)}else{const{error:i}=await d.from("site_alerts").insert([s]);i&&alert(i.message)}c(null),r(!1),x({message:"",target_date:"",target_label:"Countdown:",is_active:!1,type:"info"}),p()},j=t=>{c(t.id),x({message:t.message,target_date:t.target_date?new Date(t.target_date).toISOString().slice(0,16):"",target_label:t.target_label,is_active:t.is_active,type:t.type}),r(!0)},v=async t=>{if(!confirm("Are you sure you want to delete this alert?"))return;const{error:s}=await d.from("site_alerts").delete().eq("id",t);s?alert(s.message):p()},_=async(t,s)=>{const{error:i}=await d.from("site_alerts").update({is_active:!s}).eq("id",t);i?alert(i.message):p()};return e.jsxs("div",{className:"admin-page",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Site Alerts & Notifications"}),e.jsx("p",{style:{color:"#666"},children:"Manage high-priority notifications and countdown timers that appear in the navbar."})]}),!u&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>r(!0),children:[e.jsx(k,{size:18})," New Alert"]})]}),u&&e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"12px",border:"1px solid #eee",marginBottom:"2rem",boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.5rem"},children:[e.jsx("h2",{children:o?"Edit Alert":"Create New Alert"}),e.jsx("button",{onClick:()=>{r(!1),c(null)},style:{border:"none",background:"none",cursor:"pointer"},children:e.jsx(A,{size:24})})]}),e.jsxs("form",{onSubmit:f,style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Alert Message"}),e.jsx("textarea",{name:"message",value:a.message,onChange:l,required:!0,placeholder:"e.g. Term One Visitation Day is here!",style:{width:"100%",padding:"0.75rem",borderRadius:"6px",border:"1px solid #ddd",minHeight:"80px"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Target Date (Optional)"}),e.jsx("input",{type:"datetime-local",name:"target_date",value:a.target_date,onChange:l,style:{width:"100%",padding:"0.75rem",borderRadius:"6px",border:"1px solid #ddd"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Countdown Label"}),e.jsx("input",{type:"text",name:"target_label",value:a.target_label,onChange:l,placeholder:"e.g. Visitation Starts In:",style:{width:"100%",padding:"0.75rem",borderRadius:"6px",border:"1px solid #ddd"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:600},children:"Alert Type"}),e.jsxs("select",{name:"type",value:a.type,onChange:l,style:{width:"100%",padding:"0.75rem",borderRadius:"6px",border:"1px solid #ddd"},children:[e.jsx("option",{value:"info",children:"Info (Default)"}),e.jsx("option",{value:"urgent",children:"Urgent (Red)"}),e.jsx("option",{value:"event",children:"Event (Blue)"}),e.jsx("option",{value:"success",children:"Success (Green)"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("input",{type:"checkbox",name:"is_active",id:"is_active",checked:a.is_active,onChange:l}),e.jsx("label",{htmlFor:"is_active",style:{fontWeight:600},children:"Set as Active"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:h,children:[e.jsx(N,{size:18})," ",o?"Update Alert":"Publish Alert"]}),e.jsx("button",{type:"button",className:"btn btn-outline",onClick:()=>{r(!1),c(null)},children:"Cancel"})]})]})]}),e.jsx("div",{className:"admin-list",style:{display:"grid",gap:"1rem"},children:h&&m.length===0?e.jsx("p",{children:"Loading alerts..."}):m.length===0?e.jsx("p",{children:"No alerts created yet."}):m.map(t=>e.jsxs("div",{style:{background:"white",padding:"1.5rem",borderRadius:"12px",border:`2px solid ${t.is_active?"#f97316":"#eee"}`,display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:700,padding:"2px 8px",borderRadius:"4px",background:"#333",color:"white",textTransform:"uppercase"},children:t.type}),t.is_active&&e.jsxs("span",{style:{color:"#10b981",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(y,{size:14})," ACTIVE ON SITE"]})]}),e.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.1rem"},children:t.message}),e.jsxs("div",{style:{display:"flex",gap:"1.5rem",color:"#666",fontSize:"0.9rem"},children:[t.target_date&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(I,{size:14}),t.target_label," ",new Date(t.target_date).toLocaleString()]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(y,{size:14})," Created ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:`btn btn-sm ${t.is_active?"btn-outline":"btn-primary"}`,onClick:()=>_(t.id,t.is_active),children:t.is_active?"Deactivate":"Activate"}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>j(t),children:"Edit"}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>v(t.id),style:{color:"#dc2626"},children:e.jsx(D,{size:16})})]})]},t.id))})]})};export{R as default};
