import{r as i,s as b,j as e,F as h,g as y,C as f}from"./index-DnZapYtk.js";import{C as v}from"./check-circle-DznmAU8U.js";import{A as j}from"./alert-circle-yt1pRIJg.js";const z=()=>{const[d,c]=i.useState([]),[o,m]=i.useState(!1),[u,s]=i.useState(!1),[a,n]=i.useState({student_id:"",parent_name:"",parent_contact:"0700000000",leave_type:"sick",start_date:"",end_date:"",reason:""});i.useEffect(()=>{g()},[]);const g=async()=>{const{data:t}=await b.from("students").select("*").eq("parent_phone","0700000000");c(t||[])},x=async t=>{t.preventDefault(),m(!0);try{const{error:p}=await b.from("leave_requests").insert([a]);if(p)throw p;s(!0),n({student_id:"",parent_name:"",parent_contact:"0700000000",leave_type:"sick",start_date:"",end_date:"",reason:""}),setTimeout(()=>s(!1),5e3)}catch(p){alert("Error submitting request: "+p.message)}finally{m(!1)}},r={container:{maxWidth:"600px",margin:"0 auto",padding:"clamp(1rem, 4vw, 1.25rem)"},form:{background:"white",padding:"clamp(1rem, 4vw, 2rem)",borderRadius:"12px",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},formGroup:{marginBottom:"1.5rem"},label:{display:"block",marginBottom:"0.5rem",fontWeight:600,color:"#374151",fontSize:"clamp(0.9rem, 2.5vw, 0.95rem)"},input:{width:"100%",padding:"clamp(0.65rem, 2vw, 0.75rem)",fontSize:"clamp(0.9rem, 3vw, 1rem)",border:"2px solid #e5e7eb",borderRadius:"8px",transition:"all 0.2s",fontFamily:"inherit",backgroundColor:"white"},gridTwo:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(200px, 100%), 1fr))",gap:"1rem"}},l={borderColor:"#f97316",outline:"none",boxShadow:"0 0 0 3px rgba(249, 115, 22, 0.1)"};return e.jsxs("div",{style:r.container,children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h1",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"clamp(1.5rem, 5vw, 2rem)",marginBottom:"0.5rem"},children:[e.jsx(h,{size:32,color:"var(--color-orange)"}),"Request Leave of Absence"]}),e.jsx("p",{style:{color:"#6b7280",marginTop:"0.5rem",fontSize:"clamp(0.9rem, 3vw, 1rem)"},children:"Submit a leave request for your child. The school will review and respond within 24 hours."})]}),u&&e.jsxs("div",{style:{background:"#dcfce7",border:"1px solid #22c55e",borderRadius:"8px",padding:"clamp(0.75rem, 3vw, 1rem)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(v,{size:24,color:"#22c55e"}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#166534"},children:"Request Submitted!"}),e.jsx("p",{style:{margin:"4px 0 0",color:"#166534",fontSize:"clamp(0.85rem, 2.5vw, 0.9rem)"},children:"You'll be notified once the school reviews your request."})]})]}),e.jsxs("form",{onSubmit:x,style:r.form,children:[e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Student *"}),e.jsxs("select",{required:!0,value:a.student_id,onChange:t=>n({...a,student_id:t.target.value}),style:{...r.input,cursor:"pointer"},onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"},children:[e.jsx("option",{value:"",children:"Select Student"}),d.map(t=>e.jsxs("option",{value:t.id,children:[t.student_name," (",t.class_grade,")"]},t.id))]})]}),e.jsxs("div",{style:r.gridTwo,children:[e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Your Name *"}),e.jsx("input",{type:"text",required:!0,value:a.parent_name,onChange:t=>n({...a,parent_name:t.target.value}),placeholder:"Parent/Guardian Name",style:r.input,onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"}})]}),e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Your Contact *"}),e.jsx("input",{type:"text",required:!0,value:a.parent_contact,onChange:t=>n({...a,parent_contact:t.target.value}),placeholder:"Phone or Email",style:r.input,onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"}})]})]}),e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Leave Type *"}),e.jsxs("select",{value:a.leave_type,onChange:t=>n({...a,leave_type:t.target.value}),style:{...r.input,cursor:"pointer"},onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"},children:[e.jsx("option",{value:"sick",children:"Sick Leave"}),e.jsx("option",{value:"family_emergency",children:"Family Emergency"}),e.jsx("option",{value:"appointment",children:"Medical Appointment"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{style:r.gridTwo,children:[e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Start Date *"}),e.jsx("input",{type:"date",required:!0,value:a.start_date,onChange:t=>n({...a,start_date:t.target.value}),style:r.input,onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"}})]}),e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"End Date *"}),e.jsx("input",{type:"date",required:!0,value:a.end_date,onChange:t=>n({...a,end_date:t.target.value}),min:a.start_date,style:r.input,onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"}})]})]}),e.jsxs("div",{style:r.formGroup,children:[e.jsx("label",{style:r.label,children:"Reason for Leave *"}),e.jsx("textarea",{required:!0,rows:4,value:a.reason,onChange:t=>n({...a,reason:t.target.value}),placeholder:"Please provide details about the reason for absence...",style:{...r.input,resize:"vertical",minHeight:"100px"},onFocus:t=>Object.assign(t.target.style,l),onBlur:t=>{t.target.style.borderColor="#e5e7eb",t.target.style.boxShadow="none"}})]}),e.jsxs("div",{style:{background:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"8px",padding:"clamp(0.75rem, 3vw, 1rem)",marginBottom:"1.5rem",display:"flex",gap:"0.75rem",fontSize:"clamp(0.8rem, 2.5vw, 0.85rem)"},children:[e.jsx(j,{size:20,color:"#f59e0b",style:{flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{style:{color:"#92400e"},children:[e.jsx("strong",{children:"Important:"})," For sick leave exceeding 3 days, please attach a medical certificate. For emergencies, the school may contact you for verification."]})]}),e.jsx("button",{type:"submit",disabled:o,style:{width:"100%",padding:"clamp(0.85rem, 3vw, 1rem)",fontSize:"clamp(0.95rem, 3vw, 1rem)",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",borderRadius:"8px",border:"none",background:o?"#cbd5e1":"linear-gradient(135deg, #f97316, #ea580c)",color:"white",cursor:o?"not-allowed":"pointer",transition:"all 0.3s",boxShadow:o?"none":"0 4px 12px rgba(249, 115, 22, 0.3)"},children:o?"Submitting...":e.jsxs(e.Fragment,{children:[e.jsx(y,{size:18}),"Submit Leave Request"]})})]}),e.jsxs("div",{style:{marginTop:"clamp(1.5rem, 4vw, 2rem)"},children:[e.jsxs("h3",{style:{fontSize:"clamp(1.1rem, 4vw, 1.2rem)",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(f,{size:20}),"Previous Requests"]}),e.jsx(w,{parentContact:a.parent_contact})]})]})},w=({parentContact:d})=>{const[c,o]=i.useState([]);i.useEffect(()=>{m()},[d]);const m=async()=>{const{data:s}=await b.from("leave_requests").select(`
                *,
                students (student_name, class_grade)
            `).eq("parent_contact",d).order("created_at",{ascending:!1}).limit(5);o(s||[])},u=s=>{const a={pending:{color:"#f59e0b",bg:"#fef3c7",label:"Pending"},approved:{color:"#22c55e",bg:"#dcfce7",label:"Approved"},rejected:{color:"#ef4444",bg:"#fee2e2",label:"Rejected"}},{color:n,bg:g,label:x}=a[s]||a.pending;return e.jsx("span",{style:{padding:"4px 12px",borderRadius:"100px",background:g,color:n,fontSize:"clamp(0.7rem, 2.5vw, 0.75rem)",fontWeight:600,whiteSpace:"nowrap"},children:x})};return c.length===0?e.jsx("p",{style:{color:"#94a3b8",textAlign:"center",padding:"clamp(1.5rem, 4vw, 2rem)",fontSize:"clamp(0.9rem, 3vw, 1rem)"},children:"No previous requests."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:c.map(s=>{var a;return e.jsxs("div",{style:{background:"white",padding:"clamp(0.75rem, 3vw, 1rem)",borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsxs("div",{style:{flex:"1",minWidth:"150px"},children:[e.jsx("strong",{style:{fontSize:"clamp(0.9rem, 3vw, 1rem)"},children:(a=s.students)==null?void 0:a.student_name}),e.jsxs("p",{style:{fontSize:"clamp(0.8rem, 2.5vw, 0.85rem)",color:"#64748b",margin:"4px 0"},children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]})]}),u(s.status)]}),e.jsx("p",{style:{fontSize:"clamp(0.8rem, 2.5vw, 0.85rem)",color:"#64748b",margin:0},children:s.reason})]},s.id)})})};export{z as default};
