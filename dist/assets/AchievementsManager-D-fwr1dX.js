import{r as l,s as c,j as e,a5 as C}from"./index-DnZapYtk.js";/* empty css                    */import{S as D}from"./save-BWmYaoU4.js";import{A as v}from"./award-BXANW5Rb.js";import{T as _}from"./trash-2-CjA1UK2C.js";const L=()=>{const[d,o]=l.useState([]),[y,x]=l.useState(!0),[u,p]=l.useState(!1),[m,g]=l.useState(!1),[h,i]=l.useState({type:"",text:""}),[r,n]=l.useState({title:"",student_name:"",description:"",category:"Academics",date:new Date().toISOString().split("T")[0],image_url:""});l.useEffect(()=>{b()},[]);const b=async()=>{try{x(!0);const{data:t,error:s}=await c.from("achievements").select("*").order("date",{ascending:!1});if(s)throw s;o(t||[])}catch(t){console.error("Error fetching achievements:",t),i({type:"error",text:"Failed to load achievements"})}finally{x(!1)}},N=async t=>{t.preventDefault(),i({type:"",text:""});try{const{data:s,error:a}=await c.from("achievements").insert([r]).select().single();if(a)throw a;o([s,...d]),g(!1),n({title:"",student_name:"",description:"",category:"Academics",date:new Date().toISOString().split("T")[0],image_url:""}),i({type:"success",text:"Achievement added successfully!"})}catch(s){console.error("Error creating achievement:",s),i({type:"error",text:"Failed to add achievement"})}},w=async t=>{if(window.confirm("Delete this achievement?"))try{const{error:s}=await c.from("achievements").delete().eq("id",t);if(s)throw s;o(d.filter(a=>a.id!==t)),i({type:"success",text:"Achievement deleted successfully!"})}catch(s){console.error("Error deleting achievement:",s),i({type:"error",text:"Failed to delete achievement"})}},A=async t=>{const s=t.target.files[0];if(s){p(!0);try{const a=s.name.split(".").pop(),j=`achievements/${Date.now()}.${a}`,{error:f}=await c.storage.from("achievements").upload(j,s);if(f)throw f;const{data:{publicUrl:S}}=c.storage.from("achievements").getPublicUrl(j);n({...r,image_url:S})}catch(a){console.error("Error uploading image:",a),i({type:"error",text:"Failed to upload image"})}finally{p(!1)}}};return y?e.jsx("div",{className:"admin-content",children:e.jsx("div",{className:"admin-loading",children:"Loading..."})}):e.jsxs("div",{className:"admin-content",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Achievements Manager"}),e.jsx("p",{className:"admin-subtitle",children:"Manage student success stories"})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>g(!m),children:m?"Cancel":e.jsxs(e.Fragment,{children:[e.jsx(C,{size:18})," Add Achievement"]})})]}),h.text&&e.jsx("div",{className:`alert alert-${h.type}`,style:{marginBottom:"1.5rem"},children:h.text}),m&&e.jsxs("div",{className:"admin-card",style:{marginBottom:"2rem"},children:[e.jsx("h3",{children:"Add New Achievement"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Title *"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>n({...r,title:t.target.value}),className:"form-input",required:!0,placeholder:"e.g., National Math Contest Winner"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Student Name *"}),e.jsx("input",{type:"text",value:r.student_name,onChange:t=>n({...r,student_name:t.target.value}),className:"form-input",required:!0,placeholder:"e.g., John Doe"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:r.category,onChange:t=>n({...r,category:t.target.value}),className:"form-input",children:[e.jsx("option",{value:"Academics",children:"Academics"}),e.jsx("option",{value:"Sports",children:"Sports"}),e.jsx("option",{value:"Arts",children:"Arts"}),e.jsx("option",{value:"Leadership",children:"Leadership"}),e.jsx("option",{value:"Community",children:"Community Service"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Date"}),e.jsx("input",{type:"date",value:r.date,onChange:t=>n({...r,date:t.target.value}),className:"form-input"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>n({...r,description:t.target.value}),className:"form-input",rows:"3",placeholder:"Details about the achievement..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsx("input",{type:"file",accept:"image/*",onChange:A,className:"form-input",style:{flex:1}}),r.image_url&&e.jsx("img",{src:r.image_url,alt:"Preview",style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"4px"}})]})]}),e.jsx("div",{className:"form-actions",children:e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:u,children:[e.jsx(D,{size:18}),u?"Uploading...":"Save Achievement"]})})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsx("h3",{children:"Recent Achievements"}),d.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#64748b"},children:[e.jsx(v,{size:48,style:{margin:"0 auto 1rem"}}),e.jsx("p",{children:"No achievements added yet."})]}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"4px",overflow:"hidden",backgroundColor:"#f1f5f9"},children:t.image_url?e.jsx("img",{src:t.image_url,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(v,{size:20,style:{margin:"10px"}})})}),e.jsx("td",{children:t.title}),e.jsx("td",{children:t.student_name}),e.jsx("td",{children:e.jsx("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"600",background:"#eff6ff",color:"#1e90ff"},children:t.category})}),e.jsx("td",{children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon delete",onClick:()=>w(t.id),title:"Delete",children:e.jsx(_,{size:16})})})]},t.id))})]})})]})]})};export{L as default};
