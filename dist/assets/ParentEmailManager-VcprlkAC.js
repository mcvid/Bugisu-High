import{r as l,s as f,j as e,U as y,g as b}from"./index-EH-KDdP-.js";import{b as j}from"./emailService-DCy3Y2Ut.js";import{M as S}from"./mail-kSsI-FuV.js";import{C as k}from"./check-circle-DoFw_Y84.js";const C=()=>{const[o,p]=l.useState([]),[n,i]=l.useState([]),[c,m]=l.useState(!1),[a,d]=l.useState(null);l.useEffect(()=>{g()},[]);const g=async()=>{const{data:s}=await f.from("students").select("id, student_name, parent_name, parent_email, parent_phone").order("student_name");p(s||[])},u=async()=>{if(n.length===0){alert("Please select at least one parent");return}if(confirm(`Send portal reminder to ${n.length} parent(s)?`)){m(!0),d(null);try{const s=o.filter(r=>n.includes(r.id)).map(r=>({parent_name:r.parent_name,parent_email:r.parent_email,student_name:r.student_name})),t=await j(s);d({success:!0,message:`Successfully sent ${t.totalSent} reminder emails!`}),i([])}catch(s){d({success:!1,message:"Error sending emails: "+s.message})}finally{m(!1)}}},x=async()=>{const s=o.map(t=>t.id);i(s)},h=s=>{i(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])};return e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"2rem"},children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h1",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx(S,{size:32,color:"var(--color-orange)"}),"Parent Portal Reminders"]}),e.jsx("p",{style:{color:"#6b7280"},children:"Send portal access reminders to parents who haven't logged in yet."})]}),a&&e.jsxs("div",{style:{padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",background:a.success?"#dcfce7":"#fee2e2",border:`1px solid ${a.success?"#22c55e":"#ef4444"}`,color:a.success?"#166534":"#991b1b",display:"flex",alignItems:"center",gap:"0.75rem"},children:[a.success&&e.jsx(k,{size:20}),a.message]}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0},children:"Select Recipients"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:x,children:[e.jsx(y,{size:16})," Select All"]}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>i([]),children:"Clear All"})]})]}),e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:o.map(s=>e.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"0.75rem",borderRadius:"8px",cursor:"pointer",transition:"background 0.2s",marginBottom:"0.5rem"},onMouseEnter:t=>t.currentTarget.style.background="#f9fafb",onMouseLeave:t=>t.currentTarget.style.background="transparent",children:[e.jsx("input",{type:"checkbox",checked:n.includes(s.id),onChange:()=>h(s.id),style:{marginRight:"1rem"}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,color:"#1f2937"},children:s.parent_name||"Unknown Parent"}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:[s.student_name," â€¢ ",s.parent_email||"No email"]})]})]},s.id))})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("button",{className:"btn btn-primary",onClick:u,disabled:c||n.length===0,style:{display:"flex",alignItems:"center",gap:"0.5rem",opacity:c||n.length===0?.5:1},children:[e.jsx(b,{size:18}),c?"Sending...":`Send Reminders (${n.length})`]}),e.jsxs("span",{style:{color:"#6b7280",fontSize:"0.9rem"},children:[n.length," parent",n.length!==1?"s":""," selected"]})]})]})};export{C as default};
