import{r as a,s as r,j as e,L as g,S as b,K as h,J as y,F as C,C as L}from"./index-DnZapYtk.js";import{F as A}from"./filter-ZkGmXdqF.js";import{D as _}from"./download-BqOENLGe.js";const F=()=>{const[n,u]=a.useState([]),[j,o]=a.useState(!0),[l,x]=a.useState("All"),[t,m]=a.useState("All"),[c,v]=a.useState("");a.useEffect(()=>{p()},[]);const p=async()=>{o(!0);const{data:s,error:i}=await r.from("past_papers").select("*").order("created_at",{ascending:!1});s&&u(s),o(!1)},S=async s=>{try{await r.rpc("increment_downloads",{paper_id:s.id})}catch{await r.from("past_papers").update({downloads:s.downloads+1}).eq("id",s.id)}window.open(s.file_url,"_blank")},N=["All",...new Set(n.map(s=>s.subject))].sort(),d=n.filter(s=>{const i=l==="All"||s.level===l,f=t==="All"||s.subject===t,w=s.title.toLowerCase().includes(c.toLowerCase())||s.subject.toLowerCase().includes(c.toLowerCase());return i&&f&&w});return e.jsx("div",{className:"past-papers-page section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"page-header center",children:[e.jsx("h1",{children:"Academic Resources & Past Papers"}),e.jsx("p",{children:"Download exams, notes, and revision materials to excel in your studies."}),e.jsx("div",{style:{marginTop:"1rem"},children:e.jsx(g,{to:"/study-tips",className:"btn btn-outline",children:"View Study Tips"})})]}),e.jsxs("div",{className:"resources-toolbar card",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(b,{size:20,className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Search papers by title or subject...",value:c,onChange:s=>v(s.target.value)})]}),e.jsxs("div",{className:"filters-group",children:[e.jsxs("div",{className:"filter-select",children:[e.jsx(A,{size:16}),e.jsxs("select",{value:l,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"All",children:"All Classes"}),e.jsx("option",{value:"S1",children:"Senior 1"}),e.jsx("option",{value:"S2",children:"Senior 2"}),e.jsx("option",{value:"S3",children:"Senior 3"}),e.jsx("option",{value:"S4",children:"Senior 4"}),e.jsx("option",{value:"S5",children:"Senior 5"}),e.jsx("option",{value:"S6",children:"Senior 6"})]}),e.jsx(h,{size:14,className:"select-arrow"})]}),e.jsxs("div",{className:"filter-select",children:[e.jsx(y,{size:16}),e.jsx("select",{value:t,onChange:s=>m(s.target.value),children:N.map(s=>e.jsx("option",{value:s,children:s==="All"?"All Subjects":s},s))}),e.jsx(h,{size:14,className:"select-arrow"})]})]})]}),e.jsx("div",{className:"resources-grid",children:j?e.jsx("div",{className:"loading-state",children:"Loading resources..."}):d.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:e.jsx(C,{size:48})}),e.jsx("h3",{children:"No papers found"}),e.jsx("p",{children:"Try adjusting your search or filters."})]}):d.map(s=>e.jsxs("div",{className:"resource-card card-hover",children:[e.jsx("div",{className:"resource-icon",children:e.jsx("div",{className:`file-initial ${s.file_url.endsWith(".pdf")?"pdf":"doc"}`,children:s.file_url.endsWith(".pdf")?"PDF":"DOC"})}),e.jsxs("div",{className:"resource-content",children:[e.jsxs("div",{className:"resource-meta",children:[e.jsx("span",{className:"badge badge-sm",children:s.level}),e.jsx("span",{className:"subject-tag",children:s.subject})]}),e.jsx("h3",{className:"resource-title",children:s.title}),e.jsxs("div",{className:"resource-details",children:[e.jsxs("span",{className:"detail-item",children:[e.jsx(L,{size:14})," ",s.year," Term ",s.term]}),e.jsx("span",{className:"detail-item",children:s.paper_type})]}),e.jsxs("button",{className:"download-btn",onClick:()=>S(s),children:[e.jsx(_,{size:16})," Download"]})]})]},s.id))})]})})};export{F as default};
