import{c as we,r as o,s as n,j as e,U as I,F as P,M as Ne,X as O,a5 as z,P as Ce,C as ke}from"./index-BwtYp3Ig.js";import{s as Re,a as Ae}from"./emailService-BmJsIi8Y.js";import{S as ze}from"./settings-Di17xEj6.js";import{D as U}from"./download-Bw_uiH9L.js";import{A as V}from"./award-COrM1c8p.js";import{M as G}from"./mail-BDU_MMEc.js";import{E as X}from"./eye-DctBIEec.js";import{T as j}from"./trash-2-CNEj7xb6.js";import{C as Y}from"./check-circle-wKT-fa_O.js";import{S as Be}from"./save-BnUOIqxV.js";import{P as B}from"./pencil-DSj-Luxt.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=we("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),Oe=()=>{const[d,g]=o.useState("applications"),[p,f]=o.useState({}),[$,J]=o.useState([]),[K,Q]=o.useState([]),[y,Z]=o.useState([]),[D,ee]=o.useState([]),[W,se]=o.useState([]),[q,te]=o.useState([]),[S,ie]=o.useState([]),[re,L]=o.useState(!0),[h,x]=o.useState(null),[i,a]=o.useState({}),[w,u]=o.useState(!1),[l,N]=o.useState(null),[M,ne]=o.useState([]),[c,T]=o.useState(null),[E,ae]=o.useState("Elgon House"),le=["Elgon House","Nile House","Victoria House","Rwenzori House"];o.useEffect(()=>{m()},[]);const m=async()=>{L(!0);try{const[s,t,r,b,_,R,A,_e,Se]=await Promise.all([n.from("admissions_settings").select("*").single(),n.from("admissions_steps").select("*").order("sort_order",{ascending:!0}),n.from("admissions_requirements").select("*").order("created_at",{ascending:!0}),n.from("admissions_inquiries").select("*").order("created_at",{ascending:!1}),n.from("admissions_downloads").select("*").order("sort_order",{ascending:!0}),n.from("admission_applications").select("*").order("created_at",{ascending:!1}),n.from("newsletter_subscriptions").select("*").order("created_at",{ascending:!1}),n.from("scholarships").select("*").order("academic_year",{ascending:!1}).order("sort_order",{ascending:!0}),n.from("scholarship_applications").select("*, scholarships(title)").order("created_at",{ascending:!1})]);s.data&&f(s.data),J(t.data||[]),Q(r.data||[]),Z(b.data||[]),ee(_.data||[]),se(R.data||[]),ie(A.data||[]),te(_e.data||[]),ne(Se.data||[])}catch(s){console.error("Error fetching data:",s)}finally{L(!1)}},C=(s,t)=>{x(s),a(t),u(!1)},k=async s=>{try{if(h){const{error:t}=await n.from(s).update(i).eq("id",h);if(t)throw t}else{const{error:t}=await n.from(s).insert([i]);if(t)throw t}x(null),a({}),u(!1),m()}catch(t){alert("Error saving: "+t.message)}},de=async()=>{try{const{error:s}=await n.from("admissions_settings").update(p).eq("id",p.id);if(s)throw s;alert("Settings updated successfully"),m()}catch(s){alert("Error updating settings: "+s.message)}},F=async(s,t)=>{try{const{data:r}=await n.from("admission_applications").select("*").eq("id",s).single();if(!r){alert("Application not found");return}const{error:b}=await n.from("admission_applications").update({status:t}).eq("id",s);if(b)throw b;t==="approved"?(await Re({parent_name:r.parent_name,parent_email:r.parent_email,student_name:r.student_name,class_applying_for:r.class_applying_for})).success?alert(`Application approved! Welcome email sent to ${r.parent_email}`):alert("Application approved, but email failed to send. Please send manually."):t==="rejected"?(await Ae({parent_name:r.parent_name,parent_email:r.parent_email,student_name:r.student_name})).success&&alert(`Application rejected. Notification email sent to ${r.parent_email}`):alert("Application status updated"),m()}catch(r){alert("Error updating application: "+r.message)}},H=async(s,t)=>{try{const{error:r}=await n.from("scholarship_applications").update({status:t}).eq("id",s);if(r)throw r;alert(`Application ${t}`),T(null),m()}catch(r){alert("Error updating: "+r.message)}},oe=async(s,t)=>{const{error:r}=await n.from("admissions_inquiries").update({status:t}).eq("id",s);r?alert(r.message):m()},ce=async s=>{if(confirm(`Approve application for ${s.student_name} and create student record?`))try{const t=new Date().getFullYear(),r=Math.floor(1e3+Math.random()*9e3),b=`BHS/${t}/${r}`,{data:_,error:R}=await n.from("students").insert([{student_name:s.student_name,student_reg_number:b,parent_name:s.parent_name,parent_email:s.parent_email,parent_phone:s.parent_phone,house:E,class_grade:s.Applying_for_class||s.entry_class||"Senior 1",valid_until:`${t+4}-12-31`}]).select().single();if(R)throw R;const{error:A}=await n.from("admission_applications").update({status:"approved"}).eq("id",s.id);if(A)throw A;await n.from("notifications").insert([{student_id:_.id,recipient_phone:s.parent_phone,recipient_name:s.parent_name,type:"sms",message:`Dear ${s.parent_name}, your child ${s.student_name} has been admitted to Bugisu High School. Reg No: ${b}. Welcome!`}]),alert(`Success! Student created with Reg No: ${b}`),N(null),m()}catch(t){console.error("Approval Error:",t),alert("Failed to approve: "+t.message)}},v=async(s,t)=>{if(!window.confirm("Are you sure you want to delete this item?"))return;const{error:r}=await n.from(s).delete().eq("id",t);r?alert(r.message):m()},me=async()=>{const s=[{title:"Obtain Application Form",description:"Forms are available at the school bursar’s office or can be downloaded from our resources section.",sort_order:1},{title:"Submit Documentation",description:"Return the completed form along with previous academic reports, birth certificate copies, and passport photos.",sort_order:2},{title:"Entrance Assessment",description:"Prospective students may be required to sit a brief diagnostic assessment to determine appropriate class placement.",sort_order:3},{title:"Admission Decision",description:"Successful applicants are notified within 5 working days and issued an admission letter with reporting details.",sort_order:4},{title:"Registration & Reporting",description:"Complete the registration by paying the required fees and reporting to campus on the specified date.",sort_order:5}];confirm("Replace current procedure steps with suggested default data?")&&(await n.from("admissions_steps").delete().neq("id","00000000-0000-0000-0000-000000000000"),await n.from("admissions_steps").insert(s),m())},pe=async()=>{const s=[{title:"PLE / UCE Results Slip",description:"Evidence of standard academic qualification for O or A Level entry."},{title:"Previous Academic Reports",description:"The last two termly reports from the student’s previous school."},{title:"Birth Certificate Copy",description:"Required for age verification and official records."},{title:"Passport Photos (3)",description:"Standard studio photos for identity card and student files."},{title:"Transfer / Leaving Letter",description:"Required for students transferring between secondary schools."}];confirm("Replace current requirements with suggested default data?")&&(await n.from("admissions_requirements").delete().neq("id","00000000-0000-0000-0000-000000000000"),await n.from("admissions_requirements").insert(s),m())},he=async()=>{const s=[{title:"Application Form (PDF)",file_url:"#",sort_order:1},{title:"School Prospectus 2026",file_url:"#",sort_order:2},{title:"Fees Structure & Financial Policy",file_url:"#",sort_order:3},{title:"Student Code of Conduct",file_url:"#",sort_order:4}];confirm("Replace current resources with suggested default data?")&&(await n.from("admissions_downloads").delete().neq("id","00000000-0000-0000-0000-000000000000"),await n.from("admissions_downloads").insert(s),m())},xe=()=>l?e.jsx("div",{className:"modal-overlay",onClick:s=>s.target===s.currentTarget&&N(null),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Application Details"}),e.jsx("button",{className:"close-modal",onClick:()=>N(null),children:e.jsx(O,{size:20})})]}),e.jsxs("div",{className:"admin-grid admin-grid-2 modal-grid",children:[e.jsxs("div",{className:"info-block",children:[e.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"Student Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",l.student_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DOB:"})," ",l.date_of_birth]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Gender:"})," ",l.gender]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Nationality:"})," ",l.nationality]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Religion:"})," ",l.religion]})]}),e.jsxs("div",{className:"info-block",children:[e.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"Academic"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Program:"})," ",l.program]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Entry Class:"})," ",l.entry_class]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Previous School:"})," ",l.previous_school]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Aggregates:"})," ",l.program==="O-Level"?l.ple_aggregates:l.uce_aggregates]})]}),e.jsxs("div",{className:"info-block",children:[e.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"Parent Info"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",l.parent_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",l.parent_phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",l.parent_email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Occupation:"})," ",l.parent_occupation]})]}),e.jsxs("div",{className:"info-block",children:[e.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"0.5rem",marginBottom:"1rem"},children:"Documents"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[l.photo_url&&e.jsxs("a",{href:l.photo_url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-sm",children:[e.jsx(I,{size:16})," View Photo"]}),l.result_slip_url&&e.jsxs("a",{href:l.result_slip_url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-sm",children:[e.jsx(P,{size:16})," View Results"]})]})]})]}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[e.jsx("span",{style:{fontWeight:"bold",display:"block",marginBottom:"0.5rem"},children:"Current Status:"}),e.jsx("span",{className:`status-badge ${l.status}`,children:l.status})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem",background:"#fffbeb",padding:"1rem",borderRadius:"8px",border:"1px solid #fef3c7"},children:[e.jsx("label",{style:{fontWeight:"bold",display:"block",marginBottom:"0.5rem",color:"#92400e"},children:"Assign Student to House *"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",flexWrap:"wrap"},children:le.map(s=>e.jsx("button",{className:`btn btn-sm ${E===s?"btn-primary":"btn-outline"}`,onClick:()=>ae(s),style:E===s?{background:"#92400e",borderColor:"#92400e"}:{},children:s},s))})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>F(l.id,"under_review"),children:"Reviewing"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ce(l),style:{background:"#22c55e",borderColor:"#22c55e"},children:"Accept & Create Student"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>F(l.id,"rejected"),children:"Reject"})]})]})]})}):null,ue=()=>e.jsxs("div",{className:"admin-form-card",style:{background:"white",padding:"2rem",borderRadius:"12px",border:"1px solid #eee"},children:[e.jsx("h3",{style:{marginBottom:"1.5rem"},children:"General Admissions Settings"}),e.jsxs("div",{className:"form-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(100%, 300px), 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Admissions Overview Title"}),e.jsx("input",{type:"text",value:p.title||"",onChange:s=>f({...p,title:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Admissions Overview Description"}),e.jsx("textarea",{value:p.description||"",onChange:s=>f({...p,description:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd",minHeight:"100px"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Current Academic Year"}),e.jsx("input",{type:"text",value:p.academic_year||"",onChange:s=>f({...p,academic_year:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Inquiry Email"}),e.jsx("input",{type:"email",value:p.inquiry_email||"",onChange:s=>f({...p,inquiry_email:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]})]}),e.jsxs("button",{className:"btn btn-primary",onClick:de,style:{marginTop:"2rem"},children:[e.jsx(Be,{size:18})," Save Admissions Settings"]})]}),ge=()=>e.jsxs("div",{className:"admin-list-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("h3",{children:"Admission Procedure Steps"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:me,style:{fontSize:"0.8rem"},children:"Restore Suggested Data"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{u(!0),x(null),a({sort_order:$.length+1})},children:[e.jsx(z,{size:18})," Add Step"]})]})]}),(w||h)&&d==="steps"&&e.jsxs("div",{className:"admin-form-card",style:{background:"#f8fafc",padding:"2rem",borderRadius:"12px",marginBottom:"2rem",border:"1px solid #e2e8f0"},children:[e.jsx("h4",{children:h?"Edit Step":"New Admission Step"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",marginTop:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"Step Title",value:i.title||"",onChange:s=>a({...i,title:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsx("textarea",{placeholder:"Step Description",value:i.description||"",onChange:s=>a({...i,description:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd",minHeight:"80px"}}),e.jsx("input",{type:"number",placeholder:"Sort Order",value:i.sort_order||"",onChange:s=>a({...i,sort_order:parseInt(s.target.value)}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>k("admissions_steps"),children:"Save Step"}),e.jsx("button",{className:"btn btn-outline",onClick:()=>{u(!1),x(null),a({})},children:"Cancel"})]})]})]}),e.jsx("div",{className:"admin-list",children:$.map(s=>e.jsxs("div",{style:{background:"white",padding:"1.5rem",borderRadius:"12px",border:"1px solid #eee",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("span",{style:{fontWeight:"bold",marginRight:"1rem",color:"var(--color-primary)"},children:[s.sort_order,"."]}),e.jsx("strong",{children:s.title}),e.jsx("p",{style:{margin:"0.5rem 0 0",color:"#64748b",fontSize:"0.9rem"},children:s.description})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-icon",onClick:()=>C(s.id,s),children:e.jsx(B,{size:16})}),e.jsx("button",{className:"btn btn-icon delete",onClick:()=>v("admissions_steps",s.id),children:e.jsx(j,{size:16})})]})]},s.id))})]}),be=()=>e.jsxs("div",{className:"admin-list-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("h3",{children:"Admission Requirements"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:pe,style:{fontSize:"0.8rem"},children:"Restore Suggested Data"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{u(!0),x(null),a({})},children:[e.jsx(z,{size:18})," Add Requirement"]})]})]}),(w||h)&&d==="reqs"&&e.jsxs("div",{className:"admin-form-card",style:{background:"#f8fafc",padding:"2rem",borderRadius:"12px",marginBottom:"2rem",border:"1px solid #e2e8f0"},children:[e.jsx("h4",{children:h?"Edit Requirement":"New Requirement"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",marginTop:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"Requirement Title",value:i.title||"",onChange:s=>a({...i,title:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsx("textarea",{placeholder:"Description (Optional)",value:i.description||"",onChange:s=>a({...i,description:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd",minHeight:"60px"}}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>k("admissions_requirements"),children:"Save Requirement"}),e.jsx("button",{className:"btn btn-outline",onClick:()=>{u(!1),x(null),a({})},children:"Cancel"})]})]})]}),e.jsx("div",{className:"admin-list",children:K.map(s=>e.jsxs("div",{style:{background:"white",padding:"1.5rem",borderRadius:"12px",border:"1px solid #eee",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.title}),s.description&&e.jsx("p",{style:{margin:"0.5rem 0 0",color:"#64748b",fontSize:"0.9rem"},children:s.description})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-icon",onClick:()=>C(s.id,s),children:e.jsx(B,{size:16})}),e.jsx("button",{className:"btn btn-icon delete",onClick:()=>v("admissions_requirements",s.id),children:e.jsx(j,{size:16})})]})]},s.id))})]}),je=()=>e.jsxs("div",{className:"admin-list-section",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("h3",{children:"Admission Resources & Downloads"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-outline",onClick:he,style:{fontSize:"0.8rem"},children:"Restore Suggested Data"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{u(!0),x(null),a({sort_order:D.length+1})},children:[e.jsx(z,{size:18})," Add Resource"]})]})]}),(w||h)&&d==="downloads"&&e.jsxs("div",{className:"admin-form-card",style:{background:"#f8fafc",padding:"2rem",borderRadius:"12px",marginBottom:"2rem",border:"1px solid #e2e8f0"},children:[e.jsx("h4",{children:h?"Edit Resource":"New Resource"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",marginTop:"1rem"},children:[e.jsx("input",{type:"text",placeholder:"Resource Title (e.g. Fees Structure)",value:i.title||"",onChange:s=>a({...i,title:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsx("input",{type:"text",placeholder:"File URL (PDF link)",value:i.file_url||"",onChange:s=>a({...i,file_url:s.target.value}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsx("input",{type:"number",placeholder:"Sort Order",value:i.sort_order||"",onChange:s=>a({...i,sort_order:parseInt(s.target.value)}),style:{padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>k("admissions_downloads"),children:"Save Resource"}),e.jsx("button",{className:"btn btn-outline",onClick:()=>{u(!1),x(null),a({})},children:"Cancel"})]})]})]}),e.jsx("div",{className:"admin-list",children:D.length===0?e.jsx("p",{children:"No resources added."}):D.map(s=>e.jsxs("div",{style:{background:"white",padding:"1.5rem",borderRadius:"12px",border:"1px solid #eee",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(U,{size:20,color:"#64748b"}),e.jsxs("div",{children:[e.jsx("strong",{children:s.title}),e.jsx("p",{style:{margin:"0.25rem 0 0",color:"#3b82f6",fontSize:"0.85rem",wordBreak:"break-all"},children:s.file_url})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-icon",onClick:()=>C(s.id,s),children:e.jsx(B,{size:16})}),e.jsx("button",{className:"btn btn-icon delete",onClick:()=>v("admissions_downloads",s.id),children:e.jsx(j,{size:16})})]})]},s.id))})]}),fe=()=>e.jsxs("div",{className:"admin-list",children:[e.jsxs("h3",{style:{marginBottom:"1.5rem"},children:["Admissions Inquiries (",y.filter(s=>s.status==="pending").length," New)"]}),y.length===0?e.jsx("p",{children:"No inquiries yet."}):y.map(s=>e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"1.5rem",border:"1px solid rgba(0,0,0,0.06)",marginBottom:"1.5rem",position:"relative",transition:"all 0.3s ease"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.5rem",alignItems:"flex-start"},children:e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",fontWeight:"700",color:"#1e293b"},children:s.name}),e.jsx("span",{style:{background:s.status==="pending"?"#fef3c7":"#e0f2fe",color:s.status==="pending"?"#92400e":"#075985",padding:"0.35rem 0.75rem",borderRadius:"8px",fontSize:"0.7rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px"},children:s.status})]}),e.jsxs("div",{style:{display:"flex",gap:"2rem",color:"#64748b",fontSize:"0.9rem",flexWrap:"wrap"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(G,{size:16})," ",s.email]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ce,{size:16})," ",s.phone||"N/A"]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(ke,{size:14})," ",new Date(s.created_at).toLocaleDateString()]})]})]})}),e.jsx("div",{style:{background:"#f8fafc",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:e.jsx("p",{style:{margin:0,lineHeight:"1.6",color:"#475569"},children:s.message})}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[s.status==="pending"&&e.jsxs("button",{style:{background:"#f97316",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"10px",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease"},onClick:()=>oe(s.id,"reviewed"),onMouseEnter:t=>t.target.style.background="#ea580c",onMouseLeave:t=>t.target.style.background="#f97316",children:[e.jsx(Y,{size:16})," Mark Reviewed"]}),e.jsxs("button",{style:{background:"transparent",border:"1px solid #fee2e2",color:"#ef4444",padding:"0.6rem 1.25rem",borderRadius:"10px",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",transition:"all 0.2s ease"},onClick:()=>v("admissions_inquiries",s.id),onMouseEnter:t=>{t.target.style.background="#ef4444",t.target.style.color="white"},onMouseLeave:t=>{t.target.style.background="transparent",t.target.style.color="#ef4444"},children:[e.jsx(j,{size:16})," Delete"]})]})]},s.id))]}),ye=()=>{var s;return c?e.jsx("div",{className:"admin-modal-overlay",children:e.jsxs("div",{className:"admin-modal-card",style:{maxWidth:"600px"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Scholarship Application Details"}),e.jsx("button",{className:"btn btn-icon",onClick:()=>T(null),children:e.jsx(O,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{padding:"2rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Student Name"}),e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"600"},children:c.student_name})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Applied For"}),e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"600"},children:((s=c.scholarships)==null?void 0:s.title)||c.category})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Phone"}),e.jsx("div",{children:c.phone})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Email"}),e.jsx("div",{children:c.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Previous School"}),e.jsx("div",{children:c.previous_school})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.8rem",textTransform:"uppercase"},children:"Date Submitted"}),e.jsx("div",{children:new Date(c.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{style:{marginTop:"2rem",padding:"1.5rem",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[e.jsxs("h4",{style:{marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(P,{size:18})," Category Specific Data"]}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:c.data&&Object.entries(c.data).map(([t,r])=>e.jsxs("div",{children:[e.jsx("label",{style:{color:"#64748b",fontSize:"0.75rem",textTransform:"uppercase"},children:t.replace("_"," ")}),e.jsx("div",{style:{fontWeight:"500"},children:r})]},t))})]}),e.jsxs("div",{style:{marginTop:"2rem",display:"flex",gap:"1rem"},children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>H(c.id,"approved"),children:[e.jsx(Y,{size:18})," Approve"]}),e.jsxs("button",{className:"btn btn-outline",style:{color:"#ef4444",borderColor:"#ef4444"},onClick:()=>H(c.id,"rejected"),children:[e.jsx(j,{size:18})," Reject"]})]})]})]})}):null},ve=()=>e.jsxs("div",{className:"admin-list-section",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h3",{children:"Scholarships Management"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>{u(!0),x(null),a({academic_year:"2026/2027",coverage_type:"partial",is_active:!0,sort_order:q.length+1})},children:[e.jsx(z,{size:18})," Add Scholarship"]})]}),e.jsxs("div",{style:{marginBottom:"3rem"},children:[e.jsxs("h4",{style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(I,{size:18})," Recent Applications"]}),M.length===0?e.jsx("p",{className:"text-gray-500",children:"No applications received yet."}):e.jsx("div",{className:"admin-table-wrapper",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Category/Scholarship"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:M.map(s=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"bold"},children:s.student_name}),e.jsx("td",{children:((t=s.scholarships)==null?void 0:t.title)||s.category}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status}`,children:s.status})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>T(s),children:[e.jsx(X,{size:16})," Details"]})})]},s.id)})})]})})]}),e.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"2rem"},children:[e.jsx("h4",{style:{marginBottom:"1.5rem"},children:"Active Programs"}),(w||h)&&d==="scholarships"&&e.jsxs("div",{className:"admin-form-card",style:{background:"#f8fafc",padding:"2rem",borderRadius:"12px",marginBottom:"2rem",border:"1px solid #e2e8f0"},children:[e.jsx("h4",{children:h?"Edit Scholarship":"New Scholarship"}),e.jsxs("div",{className:"form-grid",style:{marginTop:"1rem"},children:[e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Title"}),e.jsx("input",{type:"text",placeholder:"e.g., Performance Excellence Scholarship",value:i.title||"",onChange:s=>a({...i,title:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Description"}),e.jsx("textarea",{placeholder:"Scholarship details...",value:i.description||"",onChange:s=>a({...i,description:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd",minHeight:"80px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Academic Year"}),e.jsx("input",{type:"text",value:i.academic_year||"",onChange:s=>a({...i,academic_year:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Coverage Type"}),e.jsxs("select",{value:i.coverage_type||"partial",onChange:s=>a({...i,coverage_type:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"},children:[e.jsx("option",{value:"full",children:"Full Scholarship"}),e.jsx("option",{value:"partial",children:"Partial Scholarship"}),e.jsx("option",{value:"specific",children:"Specific Coverage"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Amount (UGX)"}),e.jsx("input",{type:"number",value:i.amount||"",onChange:s=>a({...i,amount:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Deadline"}),e.jsx("input",{type:"date",value:i.deadline||"",onChange:s=>a({...i,deadline:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.85rem"},children:"Application Link (Internal/External)"}),e.jsx("input",{type:"text",placeholder:"https://...",value:i.application_link||"",onChange:s=>a({...i,application_link:s.target.value}),style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1px solid #ddd"}})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:i.is_active||!1,onChange:s=>a({...i,is_active:s.target.checked})}),e.jsx("span",{children:"Active / Visible on Site"})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",gridColumn:"1 / -1",marginTop:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>k("scholarships"),children:"Save Program"}),e.jsx("button",{className:"btn btn-outline",onClick:()=>{u(!1),x(null),a({})},children:"Cancel"})]})]})]}),e.jsx("div",{className:"admin-list",children:q.length===0?e.jsx("p",{className:"text-gray-500",children:"No scholarships found."}):q.map(s=>e.jsxs("div",{className:"admin-list-item",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:s.is_active?"#f0fdf4":"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(V,{size:24,color:s.is_active?"#22c55e":"#64748b"})}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[e.jsx("strong",{children:s.title}),e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 8px",borderRadius:"100px",background:"#f1f5f9",color:"#64748b"},children:s.academic_year})]}),e.jsxs("p",{style:{margin:"0.25rem 0 0",color:"#64748b",fontSize:"0.85rem"},children:[s.coverage_type.toUpperCase()," • ",s.amount?`${Number(s.amount).toLocaleString()} UGX`:"Contact for details"]})]})]}),e.jsxs("div",{className:"admin-list-item-actions",children:[e.jsx("button",{className:"btn btn-icon",onClick:()=>C(s.id,s),children:e.jsx(B,{size:16})}),e.jsx("button",{className:"btn btn-icon delete",onClick:()=>v("scholarships",s.id),children:e.jsx(j,{size:16})})]})]},s.id))})]})]});return e.jsxs("div",{className:"admin-manager admissions-manager admin-fade-in",children:[xe(),ye(),e.jsx("div",{className:"admin-header",children:e.jsx("h1",{children:"Admissions Management"})}),e.jsxs("div",{className:"admin-tabs",children:[e.jsxs("button",{className:`btn ${d==="applications"?"btn-primary":"btn-outline"}`,onClick:()=>g("applications"),children:[e.jsx(I,{size:18})," Applications"]}),e.jsxs("button",{className:`btn ${d==="settings"?"btn-primary":"btn-outline"}`,onClick:()=>g("settings"),children:[e.jsx(ze,{size:18})," Settings"]}),e.jsxs("button",{className:`btn ${d==="steps"?"btn-primary":"btn-outline"}`,onClick:()=>g("steps"),children:[e.jsx(De,{size:18})," Procedure"]}),e.jsxs("button",{className:`btn ${d==="reqs"?"btn-primary":"btn-outline"}`,onClick:()=>g("reqs"),children:[e.jsx(P,{size:18})," Requirements"]}),e.jsxs("button",{className:`btn ${d==="downloads"?"btn-primary":"btn-outline"}`,onClick:()=>g("downloads"),children:[e.jsx(U,{size:18})," Resources"]}),e.jsxs("button",{className:`btn ${d==="inquiries"?"btn-primary":"btn-outline"}`,onClick:()=>g("inquiries"),children:[e.jsx(Ne,{size:18})," Inquiries",y.filter(s=>s.status==="pending").length>0&&e.jsx("span",{style:{marginLeft:"6px",background:"#ef4444",color:"white",padding:"2px 6px",borderRadius:"100px",fontSize:"0.7rem"},children:y.filter(s=>s.status==="pending").length})]}),e.jsxs("button",{className:`btn ${d==="scholarships"?"btn-primary":"btn-outline"}`,onClick:()=>g("scholarships"),children:[e.jsx(V,{size:18})," Scholarships"]}),e.jsxs("button",{className:`btn ${d==="newsletter"?"btn-primary":"btn-outline"}`,onClick:()=>g("newsletter"),children:[e.jsx(G,{size:18})," Newsletter"]})]}),re?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{className:"admin-content",children:[d==="applications"&&e.jsx("div",{className:"admin-list admin-fade-in",children:W.length===0?e.jsx("p",{className:"text-gray-500",children:"No applications received yet."}):e.jsx("div",{className:"admin-table-wrapper",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref No"}),e.jsx("th",{children:"Student"}),e.jsx("th",{children:"Class"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{children:W.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"600",color:"#10b981",fontFamily:"monospace"},children:s.reference_no||"N/A"}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:s.student_name}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#666"},children:s.gender})]}),e.jsx("td",{children:s.entry_class}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status}`,children:s.status})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("button",{className:"btn btn-outline btn-sm",onClick:()=>N(s),children:[e.jsx(X,{size:16})," View"]})})]},s.id))})]})})}),d==="settings"&&ue(),d==="steps"&&ge(),d==="reqs"&&be(),d==="downloads"&&je(),d==="inquiries"&&fe(),d==="scholarships"&&ve(),d==="newsletter"&&e.jsxs("div",{className:"admin-list admin-fade-in",children:[e.jsxs("div",{className:"admin-header",children:[e.jsxs("h2",{children:["Newsletter Subscriptions (",S.length,")"]}),e.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>{const s="data:text/csv;charset=utf-8,"+["Email,Date"].concat(S.map(t=>`${t.email},${new Date(t.created_at).toLocaleDateString()}`)).join(`
`);window.open(encodeURI(s))},children:"Export CSV"})]}),S.length===0?e.jsx("p",{className:"text-gray-500",children:"No subscribers yet."}):e.jsx("div",{className:"admin-table-wrapper",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Email Address"}),e.jsx("th",{children:"Subscription Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:S.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"500"},children:s.email}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-icon delete",onClick:async()=>{confirm("Delete this subscription?")&&(await n.from("newsletter_subscriptions").delete().eq("id",s.id),m())},children:e.jsx(j,{size:16})})})]},s.id))})]})})]})]})]})};export{Oe as default};
